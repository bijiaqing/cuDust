#include "const.h"
#include "funclib.cuh"

//====================================================================================================================================================================
//====================================================================================================================================================================

__global__ 
void position_init (par *dev_grain, double *dev_prof_azi, double *dev_prof_rad, double *dev_prof_col, double *dev_prof_siz)
{
    int index = threadIdx.x + blockDim.x*blockIdx.x;
    
    if (index >= 0 && index < PAR_NUM)
    {
        dev_grain[index].azi = dev_prof_azi[index];
        dev_grain[index].rad = dev_prof_rad[index];
        dev_grain[index].col = dev_prof_col[index];
        dev_grain[index].siz = dev_prof_siz[index];
    }
}

//====================================================================================================================================================================
//====================================================================================================================================================================

__global__ 
void velocity_init (par *dev_grain, double *dev_stepnum)
{
    int index = threadIdx.x + blockDim.x*blockIdx.x;
    
    if(index >= 0 && index < PAR_NUM)
    {
        dev_grain[index].l_azi = sqrt(G*M*dev_grain[index].rad);
        dev_grain[index].v_rad = 0.0;
        dev_grain[index].l_col = 0.0;
        dev_stepnum[index]     = 1.0;
    }
}

//====================================================================================================================================================================
//====================================================================================================================================================================
